(function(b){var a=".uispinner",c;b.widget("ui.spinner",{_init:function(){var k=this,l=k.options,i=k.element,f=l.min,h=l.max,e=l.step,d=-1,j,g=i.attr("type");if((i.get(0).tagName!="INPUT")||((g!="text")&&(g!="number"))){console.error("Invalid target for ui.spinner");return}if((f==null)&&((j=i.attr("min"))!=null)){f=parseInt(j)}if((h==null)&&((j=i.attr("max"))!=null)){h=parseInt(j)}if(!e&&((j=i.attr("step"))!=null)){if(j!="any"){e=parseInt(j);l.largeStep*=e}}if((h!=null)&&(f!=null)){if(f>h){f=h}d=Math.max(Math.max(d,(h+"").length),(f+"").length)}j=i.get(0).maxLength;if(j>0){d=d>0?Math.min(j,d):j;j=Math.pow(10,d)-1;if((h==null)||(h>j)){h=j}j=-(j+1)/10+1;if((f==null)||(f<j)){f=j}}if(d>0){i.attr("maxlength",d)}l.min=f;l.max=h;l.step=e||l.defaultStep;k._createButtons(i);k._change(true);if(i.get(0).disabled){k.disable()}},_createButtons:function(e){function R(ad){return ad=="auto"?0:parseInt(ad)}var k=this,D=k.options,X=D.className,B=D.width,j=b.support.boxModel,d=e.outerHeight(),H=D.oMargin=R(e.css("margin-right")),C=k.wrapper=e.css({width:(D.oWidth=(j?e.width():e.outerWidth()))-B,marginRight:H+B,textAlign:"right"}).after('<span class="ui-spinner ui-widget"></span>').next(),w=k.btnContainer=b('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon ui-icon-triangle-1-n">&nbsp;</span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon ui-icon-triangle-1-s">&nbsp;</span></div></div>'),v,E,N,I,F=false,i=false,M=false,s=false,J,ac,S,Z,U=e.get(0).dir=="rtl",W="ui-state-active",t="ui-state-hover",q=b.ui.keyCode,O=q.UP,n=q.DOWN,V=q.RIGHT,h=q.LEFT,ab=q.PAGE_UP,L=q.PAGE_DOWN,m=q.HOME,A=q.END,z=[O,n,V,h,ab,L,m,A,q.BACKSPACE,q.DELETE,q.TAB],f=b.browser.msie;if(X){C.addClass(X)}C.append(w.css({height:d,left:-B-H,top:(e.offset().top-C.offset().top+(b.browser.msie?0:0))+"px"}));J=k.buttons=w.find(".ui-spinner-button");J.css({width:B-(j?J.outerWidth()-J.width():0),height:d/2-(j?J.outerHeight()-J.height():0)});v=b(J.get(0));E=b(J.get(1));ac=J.find(".ui-icon");ac.css({marginLeft:(J.innerWidth()-ac.width())/2,marginTop:(J.innerHeight()-ac.height())/2});w.width(J.outerWidth());S=k._getData("showOn");if(S=="hover"||S=="both"){J.add(e).bind("mouseenter"+a,G).bind("mouseleave"+a,Y)}if(S!="always"){w.css("opacity",0)}J.hover(o,Q).mousedown(l).mouseup(g).mouseout(g);if(f){J.dblclick(p).bind("selectstart",function(){return false})}e.bind("keydown"+a,y).bind("keyup"+a,r).bind("change"+a,function(){k._change()}).bind("focus"+a,T).bind("blur"+a,x);if(D.mouseWheel){b().bind(b.browser.mozilla?"DOMMouseScroll":"mousewheel",K)}function aa(){k.element.select()}function y(ah){var ae,af,ad,ag=ah.keyCode;if(ah.ctrl||ah.alt){return true}if(Z||u(ag)){return false}switch(ag){case O:case ab:ae=1;af=ag==ab;break;case n:case L:ae=-1;af=ag==L;break;case V:case h:ae=(ag==V)^U?1:-1;break;case m:ad=k._getData("min");if(ad!=null){k.setValue(ad)}return false;case A:ad=k._getData("max");if(ad!=null){k.setValue(ad)}return false}if(ae){if(!M&&!k._getData("disabled")){Z=ae;k._change();(ae>0?v:E).addClass(W);k._doSpin(ae,af);k.spinCount=1;k.inSpinTwo=false;M=true;k._setTimer(k._spin,D.spinDelayOne,ae,af)}return false}}function r(ad){if(ad.ctrl||ad.alt){return true}if(u(ad.keyCode)){return false}switch(ad.keyCode){case O:case V:case ab:case n:case h:case L:(Z>0?v:E).removeClass(W);Z=0;k._clearTimer();M=false;return false}}function u(ae){if((ae==109)||((ae>=48)&&(ae<=57))||((ae>=96)&&(ae<=105))){return false}for(var ad=0;ad<z.length;ad++){if(z[ad]==ae){return false}}return true}function P(ae){if(N){if(ae==I){return}clearInterval(N)}I=ae;N=setInterval(ad,100);function ad(){clearInterval(N);N=null;ae()}}function G(){P(function(){F=true;if(!i||(S=="hover")){k.showButtons()}})}function Y(){P(function(){F=false;if(!i||(S=="hover")){k.hideButtons()}})}function T(){f?aa():setTimeout(aa,0);i=true;c=k;if(!F&&(S=="focus"||S=="both")){k.showButtons()}}function x(){i=false;if(!F&&(S=="focus"||S=="both")){k.hideButtons()}}function p(){if(!D.disabled){k._change();k._doSpin(this===v.get(0)?1:-1)}return false}function l(){if(!D.disabled){k._change();var ad=k.element.get(0),ae=this===v.get(0)?1:-1;ad.focus();ad.select();b(this).addClass(W);k.element.focus();k._doSpin(ae);k.spinCount=1;k.inSpinTwo=false;s=true;k._setTimer(k._spin,D.spinDelayOne,ae)}return false}function g(){if(s){b(this).removeClass(W);k._clearTimer();s=false}return false}function K(ad){if(i&&(c===k)&&!D.disabled){k._change();k._doSpin((ad.wheelDelta||-ad.detail)>0?1:-1);return false}}function o(){if(!k._getData("disabled")){b(this).addClass(t)}}function Q(){if(!k._getData("disabled")){b(this).removeClass(t)}}},_spin:function(d,e){if(d>0){this.step(e)}else{this.decrement(e)}this.spinCount++;if(!this.inSpinTwo){var f=this._getData("spinsBeforeDelayTwo");if(f&&this.spinCount>f){this.inSpinTwo=true;this._setTimer(this._spin,this._getData("spinDelayTwo"),d,e)}}},_setTimer:function(h,f){var e=Array.prototype.slice.call(arguments,2),d=this;d._clearTimer();d.timer=setInterval(g,f);function g(){h.apply(d,e)}},_clearTimer:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},_doSpin:function(f,j){var k=this,d,l=k.options,i=k.value,g=l.min,h=l.max,e=(j?l.largeStep:l.step)*f;if(i==null){d=(f>0?g||h:h||g)||0}else{d=i+e}if((h!=null)&&(d>h)){d=h}else{if((g!=null)&&(d<g)){d=g}}if(d!=i){k.value=d;k.element.val(d).change()}return false},step:function(d){return this._doSpin(1,d)},decrement:function(d){return this._doSpin(-1,d)},showButtons:function(e){var d=this.btnContainer.stop();if(e){d.css("opacity",1)}else{d.fadeTo("fast",1)}},hideButtons:function(e){var d=this.btnContainer.stop();if(e){d.css("opacity",0)}else{d.fadeTo("fast",0)}this.buttons.removeClass("ui-state-hover")},setValue:function(d){this.value=d;this._fixLength(d);this.element.val(d!=null?d:"").change()},getValue:function(){return this.value},_parseValue:function(){var d=this.element.val();return d?parseInt(d):null},_change:function(h){var e=this,g=e._parseValue(),f=e._getData("min"),d=e._getData("max");if((g==null)&&!e._getData("allowNull")){g=e.value!=null?e.value:f||d}if(isNaN(g)||((f!=null)&&(g<f))||((d!=null)&&(g>d))){g=e.value}e.element.val(g!=null?g:"");e.value=g;if(!h){e.element.focus()}},enable:function(){this.buttons.removeClass("ui-state-disabled");this.element.get(0).disabled=false;b.widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass("ui-state-disabled");this.element.get(0).disabled=true;b.widget.prototype.disable.call(this)},destroy:function(d){this.wrapper.after(this.element).remove();this.element.unbind(a).css({width:this._getData("oWidth"),marginRight:this._getData("oMargin")});b.widget.prototype.destroy.call(this)}});b.extend(b.ui.spinner,{version:"1.10",getter:"getValue",defaults:{min:null,max:null,defaultStep:1,largeStep:10,className:null,showOn:"always",width:16,spinDelayOne:500,spinDelayTwo:100,spinsBeforeDelayTwo:3,mouseWheel:true,allowNull:false}})})(jQuery);